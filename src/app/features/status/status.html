<div class="status-container">

  <div class="admin-header d-flex justify-content-between align-items-center">
    <h2>Status Management</h2>

    <button class="btn btn-primary" (click)="openCreateModal()">
      + Create Status
    </button>
  </div>

  <hr />

  @if (statusService.loading()) {
  <p class="loading">Loading...</p>
  }

  <div class="card-grid">

    @for (status of statusService.statuses(); track status.id) {

    <div class="status-card card border-0 shadow-sm">

      <div class="card-header status-header">

        <div class="d-flex justify-content-between align-items-center w-100">
          <span class="status-id">
            #{{ status.id }}
          </span>

          <span class="status-badge" [class.active]="status.isActive" [class.inactive]="!status.isActive">
            {{ status.isActive ? 'Active' : 'Inactive' }}
          </span>
        </div>

      </div>

      <div class="card-body py-3 px-3">

        <h6 class="status-title">
          {{ status.name }}
        </h6>

        <small class="status-date">
          {{ status.createdAt | date }}
        </small>

        <div class="status-actions">
          <button class="btn btn-sm edit-btn" (click)="openEditModal(status)">
            Edit
          </button>

          <button class="btn btn-sm delete-btn" (click)="remove(status.id)">
            Delete
          </button>
        </div>

      </div>

    </div>

    }

  </div>

</div>

<div #statusModal class="modal fade" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">
          {{ editMode() ? 'Update Status' : 'Create Status' }}
        </h5>

        <button type="button" class="btn-close btn-close-white" (click)="closeModal()">
        </button>
      </div>

      <div class="modal-body">

        <form [formGroup]="form" (ngSubmit)="submit()">

          <div class="mb-3">
            <label class="form-label">Status Name</label>

            <input type="text" class="form-control" formControlName="name"
              [class.is-invalid]="form.controls.name.invalid && form.controls.name.touched">

            @if (form.controls.name.touched && form.controls.name.invalid) {
            <div class="invalid-feedback">
              Status name is required.
            </div>
            }
          </div>

          <div class="form-check mb-3">
            <input type="checkbox" class="form-check-input" formControlName="isActive">

            <label class="form-check-label">
              Active
            </label>
          </div>

          <div class="text-end">
            <button type="button" class="btn btn-secondary me-2" (click)="closeModal()">
              Cancel
            </button>

            <button type="submit" class="btn btn-primary" [disabled]="form.invalid">
              {{ editMode() ? 'Update' : 'Create' }}
            </button>
          </div>

        </form>

      </div>

    </div>
  </div>
</div>